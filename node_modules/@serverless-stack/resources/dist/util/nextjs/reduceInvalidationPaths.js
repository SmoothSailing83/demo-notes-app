"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.reduceInvalidationPaths = void 0;
/**
 * We don't need to invalidate sub paths if a parent has a wild card
 * invalidation. i.e. if `/users/*` exists, we don't need to invalidate `/users/details/*`
 */
const reduceInvalidationPaths = (invalidationPaths) => {
  const wildCardDirectories = invalidationPaths
    .filter((invalidationPath) => invalidationPath.endsWith("/*"))
    .map((invalidationPath) => invalidationPath.replace("/*", ""));
  return invalidationPaths.filter((invalidationPath) => {
    return !wildCardDirectories.some(
      (wildCardDirectory) =>
        invalidationPath.startsWith(wildCardDirectory) &&
        invalidationPath !== `${wildCardDirectory}*` &&
        invalidationPath !== `${wildCardDirectory}/*` &&
        wildCardDirectory !== invalidationPath
    );
  });
};
exports.reduceInvalidationPaths = reduceInvalidationPaths;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVkdWNlSW52YWxpZGF0aW9uUGF0aHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvdXRpbC9uZXh0anMvcmVkdWNlSW52YWxpZGF0aW9uUGF0aHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUE7OztHQUdHO0FBQ0ksTUFBTSx1QkFBdUIsR0FBRyxDQUNyQyxpQkFBMkIsRUFDakIsRUFBRTtJQUNaLE1BQU0sbUJBQW1CLEdBQUcsaUJBQWlCO1NBQzFDLE1BQU0sQ0FBQyxDQUFDLGdCQUFnQixFQUFFLEVBQUUsQ0FBQyxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7U0FDN0QsR0FBRyxDQUFDLENBQUMsZ0JBQWdCLEVBQUUsRUFBRSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUVqRSxPQUFPLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxDQUFDLGdCQUFnQixFQUFFLEVBQUU7UUFDbkQsT0FBTyxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FDOUIsQ0FBQyxpQkFBaUIsRUFBRSxFQUFFLENBQ3BCLGdCQUFnQixDQUFDLFVBQVUsQ0FBQyxpQkFBaUIsQ0FBQztZQUM5QyxnQkFBZ0IsS0FBSyxHQUFHLGlCQUFpQixHQUFHO1lBQzVDLGdCQUFnQixLQUFLLEdBQUcsaUJBQWlCLElBQUk7WUFDN0MsaUJBQWlCLEtBQUssZ0JBQWdCLENBQ3pDLENBQUM7SUFDSixDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQztBQWhCVyxRQUFBLHVCQUF1QiwyQkFnQmxDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBXZSBkb24ndCBuZWVkIHRvIGludmFsaWRhdGUgc3ViIHBhdGhzIGlmIGEgcGFyZW50IGhhcyBhIHdpbGQgY2FyZFxuICogaW52YWxpZGF0aW9uLiBpLmUuIGlmIGAvdXNlcnMvKmAgZXhpc3RzLCB3ZSBkb24ndCBuZWVkIHRvIGludmFsaWRhdGUgYC91c2Vycy9kZXRhaWxzLypgXG4gKi9cbmV4cG9ydCBjb25zdCByZWR1Y2VJbnZhbGlkYXRpb25QYXRocyA9IChcbiAgaW52YWxpZGF0aW9uUGF0aHM6IHN0cmluZ1tdXG4pOiBzdHJpbmdbXSA9PiB7XG4gIGNvbnN0IHdpbGRDYXJkRGlyZWN0b3JpZXMgPSBpbnZhbGlkYXRpb25QYXRoc1xuICAgIC5maWx0ZXIoKGludmFsaWRhdGlvblBhdGgpID0+IGludmFsaWRhdGlvblBhdGguZW5kc1dpdGgoXCIvKlwiKSlcbiAgICAubWFwKChpbnZhbGlkYXRpb25QYXRoKSA9PiBpbnZhbGlkYXRpb25QYXRoLnJlcGxhY2UoXCIvKlwiLCBcIlwiKSk7XG5cbiAgcmV0dXJuIGludmFsaWRhdGlvblBhdGhzLmZpbHRlcigoaW52YWxpZGF0aW9uUGF0aCkgPT4ge1xuICAgIHJldHVybiAhd2lsZENhcmREaXJlY3Rvcmllcy5zb21lKFxuICAgICAgKHdpbGRDYXJkRGlyZWN0b3J5KSA9PlxuICAgICAgICBpbnZhbGlkYXRpb25QYXRoLnN0YXJ0c1dpdGgod2lsZENhcmREaXJlY3RvcnkpICYmXG4gICAgICAgIGludmFsaWRhdGlvblBhdGggIT09IGAke3dpbGRDYXJkRGlyZWN0b3J5fSpgICYmXG4gICAgICAgIGludmFsaWRhdGlvblBhdGggIT09IGAke3dpbGRDYXJkRGlyZWN0b3J5fS8qYCAmJlxuICAgICAgICB3aWxkQ2FyZERpcmVjdG9yeSAhPT0gaW52YWxpZGF0aW9uUGF0aFxuICAgICk7XG4gIH0pO1xufTtcbiJdfQ==
